---
import { WorkResultProject } from '../../data/workResults';
import { ExternalLink } from 'lucide-react';

interface Props {
  project: WorkResultProject;
  lang: 'en' | 'id';
}

const { project, lang } = Astro.props;

const bannerImage = project.image.find(img => img.title === 'banner');
const displayImage = bannerImage?.image || project.image[0]?.image || '';

const labels = {
  en: {
    production: 'Production',
    demo: 'Demo',
    viewProject: 'View Project',
  },
  id: {
    production: 'Produksi',
    demo: 'Demo',
    viewProject: 'Lihat Proyek',
  },
};

const t = labels[lang] || labels.en;
---

<article 
  class="work-result-card group relative bg-background/40 backdrop-blur-sm border border-border/50 rounded-2xl overflow-hidden hover:border-brand/50 transition-all duration-500 hover:shadow-xl hover:shadow-brand/5 hover:-translate-y-1 cursor-pointer"
  data-project={JSON.stringify(project)}
>
  <!-- Image -->
  <div class="relative aspect-video overflow-hidden bg-secondary/20">
    {displayImage ? (
      <img
        src={displayImage}
        alt={project.title}
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
        loading="lazy"
        decoding="async"
        width="605"
        height="312"
        sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
        onerror="this.onerror=null; this.parentElement.innerHTML='<div class=\\'w-full h-full bg-linear-to-br from-brand/20 via-brand/10 to-secondary/20 flex items-center justify-center\\'><div class=\\'text-center p-4\\'><svg class=\\'w-12 h-12 mx-auto mb-2 text-muted-foreground/50\\' fill=\\'none\\' viewBox=\\'0 0 24 24\\' stroke=\\'currentColor\\'><path stroke-linecap=\\'round\\' stroke-linejoin=\\'round\\' stroke-width=\\'1.5\\' d=\\'M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\\' /></svg><p class=\\'text-xs text-muted-foreground/70\\'>' + this.alt + '</p></div></div>';"
      />
    ) : (
      <div class="w-full h-full bg-linear-to-br from-brand/20 via-brand/10 to-secondary/20 flex items-center justify-center">
        <div class="text-center p-4">
          <svg class="w-12 h-12 mx-auto mb-2 text-muted-foreground/50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <p class="text-xs text-muted-foreground/70">{project.title}</p>
        </div>
      </div>
    )}
    <div class="absolute inset-0 bg-gradient-to-t from-background/90 via-background/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
    
    <!-- Overlay Button -->
    <button
      type="button"
      class="work-result-card-btn absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 cursor-pointer z-10 pointer-events-none group-hover:pointer-events-auto"
      data-project={JSON.stringify(project)}
    >
      <span class="inline-flex items-center gap-2 px-6 py-3 bg-brand text-white rounded-full font-medium text-sm shadow-lg transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
        {t.viewProject}
        <ExternalLink className="w-4 h-4" />
      </span>
    </button>
  </div>
  
  <!-- Content -->
  <div class="p-6">
    <!-- Title -->
    <h3 class="text-xl font-bold mb-2 group-hover:text-brand transition-colors">
      {project.title}
    </h3>
    
    <!-- Description -->
    <p class="text-muted-foreground text-sm mb-4 line-clamp-3">
      {project.description}
    </p>
    
    <!-- Technologies -->
    <div class="flex flex-wrap gap-2">
      {project.technologies.slice(0, 4).map((tech) => (
        <span class="px-2 py-1 text-xs font-medium bg-secondary/50 text-muted-foreground rounded">
          {tech}
        </span>
      ))}
      {project.technologies.length > 4 && (
        <span class="px-2 py-1 text-xs font-medium bg-secondary/50 text-muted-foreground rounded">
          +{project.technologies.length - 4}
        </span>
      )}
    </div>
  </div>
</article>

