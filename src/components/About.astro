---
import { pricingData } from '../data/pricing';
import { ArrowRight } from 'lucide-react';
import ParallaxGallery from './ui/ParallaxGallery';
import { LottieIcon } from './ui/LottieIcon';
import { getWhatsAppLink } from '../lib/utils';

const { lang } = Astro.props;
const about = pricingData[lang].about;
const process = pricingData[lang].process;
const energy = pricingData[lang].energy;

// Function to convert markdown bold to HTML
function markdownToHtml(text: string): string {
  return text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
}

// Lottie icon paths for energy cards
const energyIcons = [
  '/icon/artificial-intelligence.gif',
  '/icon/disguise.gif',
  '/icon/night.gif',
  '/icon/happy-friends.gif',
];

// Gallery images - Using local images from /public/image folder
// All images are WebP format for optimal performance
const galleryImages = [
  // Column 1
  '/image/Screenshot 2025-11-29 at 09-38-07 Top Gun Barber Shop - Look Sharp. Feel Top.webp',
  '/image/Screenshot 2025-11-29 at 09-28-15 Fiber Monitoring.webp',
  '/image/Screenshot 2025-11-29 at 09-28-32 Fiber Monitoring.webp',

  // Column 2
  '/image/Screenshot 2025-11-29 at 09-29-54 Fiber Monitoring.webp',
  '/image/Screenshot 2025-11-29 at 09-38-23 Jade Inc - Field Research & Coordination Services.webp',
  '/image/Screenshot 2025-11-29 at 09-55-57 CleanLink - Laundry Service Management System.webp',
  '/image/Screenshot 2025-11-29 at 09-38-44 Savlo — Simple Secure Financing for Small Businesses.webp',
  '/image/Screenshot 2025-11-29 at 08-52-19 Fiber Monitoring.webp',

  // Column 3
  '/image/Screenshot 2026-01-07 at 19-49-13 CRM Healthcare Platform.webp',
  '/image/Screenshot 2026-01-07 at 19-48-42 CRM Healthcare Platform.webp',
  '/image/Screenshot 2025-11-29 at 09-32-48 Adhara Eka - Portfolio.webp',
  '/image/Screenshot 2025-11-29 at 09-37-04 Top Gun Barber Shop - Look Sharp. Feel Top.webp',
  '/image/Screenshot 2025-11-29 at 09-29-20 Fiber Monitoring.webp',
  
  // Column 4
  '/image/Screenshot 2026-01-07 at 19-49-59 CRM Healthcare Platform.webp',
  '/image/Screenshot 2025-11-29 at 09-40-02 Savlo — Simple Secure Financing for Small Businesses.webp',
  '/image/Screenshot 2025-11-29 at 09-38-14 Top Gun Barber Shop - Look Sharp. Feel Top.webp',
  '/image/Screenshot 2025-11-29 at 09-33-07 Adhara Eka - Portfolio.webp',
  '/image/Screenshot 2025-11-29 at 09-37-26 Top Gun Barber Shop - Look Sharp. Feel Top.webp',
];

// Energy card data for cleaner iteration
const energyCards = [
  { 
    titleEn: 'Curiosity', 
    titleId: 'Rasa Ingin Tahu',
    descEn: 'We ask questions. We explore. We learn.',
    descId: 'Kami bertanya. Kami menjelajah. Kami belajar.'
  },
  { 
    titleEn: 'Jokes & Fun', 
    titleId: 'Candaan & Fun',
    descEn: 'Laughter keeps us creative and connected.',
    descId: 'Tertawa membuat kami kreatif dan terhubung.'
  },
  { 
    titleEn: 'Late Nights', 
    titleId: 'Larut Malam',
    descEn: 'When the best ideas come alive.',
    descId: 'Saat ide terbaik muncul.'
  },
  { 
    titleEn: 'Shared Vibes', 
    titleId: 'Vibe Bersama',
    descEn: 'Playlists that fuel our flow.',
    descId: 'Playlist yang memicu alur kerja kami.'
  },
];
---

<section id="about" class="relative border-b border-border/50 bg-background">
  {/* Text Section - "Here's a sneak peek" */}
  <section id="sneak-peek">
    <div class="container mx-auto px-4">
    </div>
  </section>

  {/* Parallax Gallery Section */}
  <section id="design-showcase" class="relative bg-background flex items-center justify-center overflow-hidden z-10 w-full">
    <ParallaxGallery client:load images={galleryImages} lang={lang} />
  </section>

  <div class="container mx-auto px-4 py-24 md:py-32">
    {/* Process Section - Minimalist White Background */}
    <section class="mb-16 sm:mb-20 md:mb-24 lg:mb-32">
      {/* Header with generous whitespace */}
      <div class="max-w-3xl mx-auto text-center mb-8 sm:mb-12 md:mb-16 lg:mb-20 px-4">
        <p class="text-[0.65rem] sm:text-xs font-medium uppercase tracking-widest text-muted-foreground mb-3 md:mb-4">
          {process.subtitle}
        </p>
        <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold tracking-tight text-foreground leading-tight">
          {process.title}
        </h2>
      </div>

      {/* Process Steps - Centered Card Layout */}
      <div class="max-w-5xl mx-auto px-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 md:gap-8 lg:gap-12">
          {process.body.map((step: string, index: number) => (
            <div class="group relative text-center">
              {/* Step number - centered */}
              <div class="flex justify-center mb-4 sm:mb-5 md:mb-6">
                <span class="flex items-center justify-center w-12 h-12 sm:w-12 sm:h-12 md:w-14 md:h-14 text-xl sm:text-2xl font-bold text-foreground border-2 border-foreground rounded-full transition-colors group-hover:bg-foreground group-hover:text-background">
                  {index + 1}
                </span>
              </div>
              {/* Step content - centered */}
              <p class="text-base sm:text-lg md:text-xl text-foreground leading-relaxed px-2" set:html={markdownToHtml(step)} />
            </div>
          ))}
        </div>
      </div>
    </section>

    {/* Energy Section - Bento Grid Layout */}
    <section class="relative">
      {/* Header */}
      <div class="text-center mb-16">
        <p class="text-xs font-medium uppercase tracking-widest text-muted-foreground mb-4">
          {energy.subtitle}
        </p>
        <h2 class="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight text-foreground mb-6">
          {energy.title}
        </h2>
        <p class="text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto">
          {energy.body[0]}
        </p>
      </div>

      {/* Bento Grid */}
      <div class="grid grid-cols-1 md:grid-cols-12 gap-4 md:gap-6">
        {/* Large featured card - spans 8 cols - BLACK */}
        <div class="md:col-span-8 bg-foreground text-background rounded-3xl p-8 md:p-12 relative overflow-hidden group">
          <div class="relative z-10">
            <div class="w-20 h-20 mb-8">
              <LottieIcon 
                client:visible 
                src={energyIcons[0]} 
                className="w-full h-full invert"
              />
            </div>
            <h3 class="text-2xl md:text-3xl font-bold mb-4">
              {lang === 'en' ? energyCards[0].titleEn : energyCards[0].titleId}
            </h3>
            <p class="text-lg text-background/80 max-w-md leading-relaxed">
              {lang === 'en' ? energyCards[0].descEn : energyCards[0].descId}
            </p>
            <p class="mt-6 text-sm text-background/60 leading-relaxed max-w-lg">
              {energy.body[1]}
            </p>
          </div>
          {/* Decorative element */}
          <div class="absolute -right-20 -bottom-20 w-64 h-64 bg-background/10 rounded-full transition-transform duration-500 group-hover:scale-110" />
        </div>

        {/* Stacked cards - spans 4 cols */}
        <div class="md:col-span-4 flex flex-col gap-4 md:gap-6">
          {/* Card 2 - BLACK */}
          <div class="flex-1 bg-foreground text-background rounded-3xl p-6 md:p-8 group hover:bg-foreground/90 transition-colors">
            <div class="w-14 h-14 mb-4">
              <LottieIcon 
                client:visible 
                src={energyIcons[1]} 
                className="w-full h-full invert"
              />
            </div>
            <h3 class="text-xl font-bold mb-2">
              {lang === 'en' ? energyCards[1].titleEn : energyCards[1].titleId}
            </h3>
            <p class="text-sm text-background/70 leading-relaxed">
              {lang === 'en' ? energyCards[1].descEn : energyCards[1].descId}
            </p>
          </div>
          {/* Card 3 - BLACK */}
          <div class="flex-1 bg-foreground text-background rounded-3xl p-6 md:p-8 group hover:bg-foreground/90 transition-colors">
            <div class="w-14 h-14 mb-4">
              <LottieIcon 
                client:visible 
                src={energyIcons[2]} 
                className="w-full h-full invert"
              />
            </div>
            <h3 class="text-xl font-bold mb-2">
              {lang === 'en' ? energyCards[2].titleEn : energyCards[2].titleId}
            </h3>
            <p class="text-sm text-background/70 leading-relaxed">
              {lang === 'en' ? energyCards[2].descEn : energyCards[2].descId}
            </p>
          </div>
        </div>

        {/* Bottom row - two equal cards */}
        {/* Card 4 - BLACK */}
        <div class="md:col-span-6 bg-foreground text-background rounded-3xl p-6 md:p-8 group hover:bg-foreground/90 transition-colors">
          <div class="flex items-start gap-6">
            <div class="w-16 h-16 shrink-0">
              <LottieIcon 
                client:visible 
                src={energyIcons[3]} 
                className="w-full h-full invert"
              />
            </div>
            <div>
              <h3 class="text-xl font-bold mb-2">
                {lang === 'en' ? energyCards[3].titleEn : energyCards[3].titleId}
              </h3>
              <p class="text-sm text-background/70 leading-relaxed">
                {lang === 'en' ? energyCards[3].descEn : energyCards[3].descId}
              </p>
            </div>
          </div>
        </div>

        {/* CTA - Brutalist Style */}
        <a 
          href={getWhatsAppLink('about', lang)} 
          target="_blank" 
          rel="noopener noreferrer"
          class="md:col-span-6 group flex items-center justify-center rounded-3xl border-2 border-foreground hover:bg-foreground hover:text-background transition-colors duration-300"
        >
          <span class="text-3xl md:text-4xl lg:text-5xl font-bold tracking-tight py-12 md:py-16">
            {lang === 'en' ? 'Start Your Project' : 'Mulai Proyek Anda'}
            <ArrowRight className="inline-block w-8 h-8 md:w-10 md:h-10 ml-3 transition-transform group-hover:translate-x-2" />
          </span>
        </a>
      </div>
    </section>
  </div>
</section>
